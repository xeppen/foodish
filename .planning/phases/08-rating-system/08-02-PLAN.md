---
phase: 08-rating-system
plan: 02
type: execute
wave: 1
depends_on:
  - 08-01
files_modified:
  - lib/actions/meals.ts
  - lib/actions/meals.test.ts
  - components/meal-list.tsx
autonomous: true
---

# 08-02 Plan: Rating Server Action + Optimistic Update

## Objective
Persist meal ratings and make UI updates feel instant.

## Scope
- Add `rateMeal(id, rating)` server action in `lib/actions/meals.ts`.
- Wire `MealList` rating interactions to action.
- Add optimistic local state update with rollback on failure.

## Tasks
1. Add strict enum validation for rating updates.
2. Verify user ownership before update.
3. Add tests for valid rating transitions and unauthorized/invalid inputs.

## Verification
- Clicking rating updates UI immediately.
- Refresh shows persisted rating from DB.
- Error path reverts optimistic state.

## Success Criteria
- `RATING-01` and `RATING-02` and optimistic behavior are satisfied.
